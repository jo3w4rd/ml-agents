<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Brains </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Brains ">
    <meta name="generator" content="docfx 2.34.0.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc">
    <meta property="docfx:tocrel" content="toc">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" src="../images/logo.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
                <ul class="nav level1 navbar-nav">
                  <li class="active">
                    <a href="../articles/ML-Agents-Overview.html" title="Manual" class="active">Manual</a>
                  </li>
                  <li class="">
                    <a href="../zh-CN/ML-Agents-Overview.html" title="Chinese Manual" class="">Chinese Manual</a>
                  </li>
                  <li class="">
                    <a href="../csharp-api/Unity.MLAgents.html" title="C# Script Reference" class="">C# Script Reference</a>
                  </li>
                  <li class="">
                    <a href="../python-api/Python-API.html" title="Python Script Reference" class="">Python Script Reference</a>
                  </li>
                </ul>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div>
              <div class="sidefilter">
                <form class="toc-filter">
                  <span class="glyphicon glyphicon-filter filter-icon"></span>
                  <input type="text" id="toc_filter_input" placeholder="Enter here to filter..." onkeypress="if(event.keyCode==13) {return false;}">
                </form>
              </div>
              <div class="sidetoc">
                <div class="toc" id="toc">
                  
                  <ul class="nav level1">
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Getting Started</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <span class="expand-stub"></span>
                            <a href="ML-Agents-Overview.html" title="ML-Agents Overview" class="">ML-Agents Overview</a>
                              
                              <ul class="nav level3">
                                <li class="">
                                  <a href="Background-Unity.html" title="Background Unity" class="">Background Unity</a>
                                </li>
                                <li class="">
                                  <a href="Background-Machine-Learning.html" title="Background Machine Learning" class="">Background Machine Learning</a>
                                </li>
                                <li class="">
                                  <a href="Background-TensorFlow.html" title="Background TensorFlow" class="">Background TensorFlow</a>
                                </li>
                              </ul>  </li>
                          <li class="">
                            <span class="expand-stub"></span>
                            <a href="Installation.html" title="Installation &amp; Setup" class="">Installation &amp; Setup</a>
                              
                              <ul class="nav level3">
                                <li class="">
                                  <a href="Background-Jupyter.html" title="Background Jupyter Notebooks" class="">Background Jupyter Notebooks</a>
                                </li>
                                <li class="">
                                  <a href="Using-Docker.html" title="Background Docker Setup" class="">Background Docker Setup</a>
                                </li>
                              </ul>  </li>
                          <li class="">
                            <a href="Getting-Started-with-Balance-Ball.html" title="Getting Started with the 3D Balance Ball Environment" class="">Getting Started with the 3D Balance Ball Environment</a>
                          </li>
                          <li class="">
                            <a href="Learning-Environment-Examples.html" title="Example Environment" class="">Example Environment</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Creating Learning Environments</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="Learning-Environment-Create-New.html" title="Making a New Learning environment" class="">Making a New Learning environment</a>
                          </li>
                          <li class="">
                            <a href="Learning-Environment-Design.html" title="Designing a Learning environment" class="">Designing a Learning environment</a>
                          </li>
                          <li class="">
                            <a href="Learning-Environment-Best-Practices.html" title="Learning Environment Best Practices" class="">Learning Environment Best Practices</a>
                          </li>
                          <li class="">
                            <a href="Feature-Monitor.html" title="Using the Monitor Class" class="">Using the Monitor Class</a>
                          </li>
                          <li class="">
                            <a href="Using-TensorFlow-Sharp-in-Unity.html" title="TensorFlowSharp in Unity" class="">TensorFlowSharp in Unity</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Training</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="Training-ML-Agents.html" title="Training ML-Agents" class="">Training ML-Agents</a>
                          </li>
                          <li class="">
                            <a href="Training-PPO.html" title="Training with Proximal Policy Optimization" class="">Training with Proximal Policy Optimization</a>
                          </li>
                          <li class="">
                            <a href="Training-Curriculum-Learning.html" title="Training with Curriculum Learning" class="">Training with Curriculum Learning</a>
                          </li>
                          <li class="">
                            <a href="Training-Imitation-Learning.html" title="Training with Imitation Learning" class="">Training with Imitation Learning</a>
                          </li>
                          <li class="">
                            <a href="Feature-Memory.html" title="Training with LSTM" class="">Training with LSTM</a>
                          </li>
                          <li class="">
                            <a href="Training-on-Amazon-Web-Service.html" title="Training on the Cloud with Amazon Web Services" class="">Training on the Cloud with Amazon Web Services</a>
                          </li>
                          <li class="">
                            <a href="Using-Tensorboard.html" title="Using TensorBoard to Observe Training" class="">Using TensorBoard to Observe Training</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Help</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="Migrating-v0.3.html" title="Migrating to ML-Agents v.0.3" class="">Migrating to ML-Agents v.0.3</a>
                          </li>
                          <li class="">
                            <a href="Glossary.html" title="ML-Agents Glossary" class="">ML-Agents Glossary</a>
                          </li>
                          <li class="">
                            <a href="Limitations-and-Common-Issues.html" title="Limitations &amp; Common Issues" class="">Limitations &amp; Common Issues</a>
                          </li>
                        </ul>  </li>
                  </ul>        </div>
              </div>
            </div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="brains">Brains</h1>

<p>The Brain encapsulates the decision making process. Brain objects must be children of the Academy in the Unity scene hierarchy. Every Agent must be assigned a Brain, but you can use the same Brain with more than one Agent. You can also create several Brains, attach each of the Brain to one or more than one Agent.  </p>
<p>Use the Brain class directly, rather than a subclass. Brain behavior is determined by the <strong>Brain Type</strong>. ML-Agents defines four Brain Types:</p>
<ul>
<li><a href="Learning-Environment-Design-External-Internal-Brains.html">External</a> — The <strong>External</strong> and <strong>Internal</strong> types typically work together; set <strong>External</strong> when training your agents. You can also use the <strong>External</strong> brain to communicate with a Python script via the Python <code>UnityEnvironment</code> class included in the Python portion of the ML-Agents SDK.</li>
<li><a href="Learning-Environment-Design-External-Internal-Brains.html">Internal</a> – Set <strong>Internal</strong>  to make use of a trained model.</li>
<li><a href="Learning-Environment-Design-Heuristic-Brains.html">Heuristic</a> – Set <strong>Heuristic</strong> to hand-code the agent&#39;s logic by extending the Decision class.</li>
<li><a href="Learning-Environment-Design-Player-Brains.html">Player</a> – Set <strong>Player</strong> to map keyboard keys to agent actions, which can be useful to test your agent code.</li>
</ul>
<p>During training, set your agent&#39;s brain type to <strong>External</strong>. To use the trained model, import the model file into the Unity project and change the brain type to <strong>Internal</strong>. </p>
<p>The Brain class has several important properties that you can set using the Inspector window. These properties must be appropriate for the agents using the brain. For example, the <code>Vector Observation Space Size</code> property must match the length of the feature vector created by an agent exactly. See <a href="Learning-Environment-Design-Agents.html">Agents</a> for information about creating agents and setting up a Brain instance correctly.</p>
<h2 id="brain-properties">Brain Properties</h2>
<p>The Brain Inspector window in the Unity Editor displays the properties assigned to a Brain component:</p>
<p><img src="../images/brain.png" alt="Brain Inspector"></p>
<ul>
<li><code>Brain Parameters</code> - Define vector observations, visual observation, and vector actions for the Brain.<ul>
<li><code>Vector Observation</code> <ul>
<li><code>Space Type</code> - Corresponds to whether the observation vector contains a single integer (Discrete) or a series of real-valued floats (Continuous).</li>
<li><code>Space Size</code> - Length of vector observation for brain (In <em>Continuous</em> space type). Or number of possible values (in <em>Discrete</em> space type).</li>
<li><code>Stacked Vectors</code> - The number of previous vector observations that will be stacked and used collectively for decision making. This results in the effective size of the vector observation being passed to the brain being: <em>Space Size</em> x <em>Stacked Vectors</em>.</li>
</ul>
</li>
<li><code>Visual Observations</code> - Describes height, width, and whether to grayscale visual observations for the Brain.</li>
<li><code>Vector Action</code><ul>
<li><code>Space Type</code> - Corresponds to whether action vector contains a single integer (Discrete) or a series of real-valued floats (Continuous).</li>
<li><code>Space Size</code> - Length of action vector for brain (In <em>Continuous</em> state space). Or number of possible values (in <em>Discrete</em> action space).</li>
<li><code>Action Descriptions</code> - A list of strings used to name the available actions for the Brain.</li>
</ul>
</li>
</ul>
</li>
<li><code>Type of Brain</code> - Describes how the Brain will decide actions.<ul>
<li><code>External</code> - Actions are decided by an external process, such as the PPO training process.</li>
<li><code>Internal</code> - Actions are decided using internal TensorFlowSharp model.</li>
<li><code>Player</code> - Actions are decided using keyboard input mappings.</li>
<li><code>Heuristic</code> - Actions are decided using a custom <code>Decision</code> script, which must be attached to the Brain game object.</li>
</ul>
</li>
</ul>
<h2 id="using-the-broadcast-feature">Using the Broadcast Feature</h2>
<p>The Player, Heuristic and Internal brains have been updated to support broadcast. The broadcast feature allows you to collect data from your agents using a Python program without controlling them.  </p>
<h3 id="how-to-use-unity">How to use: Unity</h3>
<p>To turn it on in Unity, simply check the <code>Broadcast</code> box as shown bellow:</p>
<p><img src="../images/broadcast.png" alt="Broadcast"></p>
<h3 id="how-to-use-python">How to use: Python</h3>
<p>When you launch your Unity Environment from a Python program, you can see what the agents connected to non-external brains are doing. When calling <code>step</code> or <code>reset</code> on your environment, you retrieve a dictionary mapping brain names to <code>BrainInfo</code> objects. The  dictionary contains a <code>BrainInfo</code> object for each non-external brain set to broadcast as well as for any external brains.  </p>
<p>Just like with an external brain, the <code>BrainInfo</code> object contains the fields for <code>visual_observations</code>, <code>vector_observations</code>,  <code>text_observations</code>, <code>memories</code>,<code>rewards</code>, <code>local_done</code>, <code>max_reached</code>, <code>agents</code> and <code>previous_actions</code>. Note that <code>previous_actions</code> corresponds to the actions that were taken by the agents at the previous step, not the current one.  </p>
<p>Note that when you do a <code>step</code> on the environment, you cannot provide actions for non-external brains. If there are no external brains in the scene, simply call <code>step()</code> with no arguments.  </p>
<p>You can use the broadcast feature to collect data generated by Player, Heuristics or Internal brains game sessions. You can then use this data to train an agent in a supervised context.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/Unity-Technologies/ml-agents/blob/feature-docfx/doc-src/articles/Learning-Environment-Design-Brains.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
