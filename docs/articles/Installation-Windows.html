<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Installing ML-Agents for Windows </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Installing ML-Agents for Windows ">
    <meta name="generator" content="docfx 2.34.0.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc">
    <meta property="docfx:tocrel" content="toc">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" src="../images/logo.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
                <ul class="nav level1 navbar-nav">
                  <li class="active">
                    <a href="../articles/ML-Agents-Overview.html" title="Manual" class="active">Manual</a>
                  </li>
                  <li class="">
                    <a href="../zh-CN/ML-Agents-Overview.html" title="Chinese Manual" class="">Chinese Manual</a>
                  </li>
                  <li class="">
                    <a href="../csharp-api/Unity.MLAgents.html" title="C# Script Reference" class="">C# Script Reference</a>
                  </li>
                  <li class="">
                    <a href="../python-api/Python-API.html" title="Python Script Reference" class="">Python Script Reference</a>
                  </li>
                </ul>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div>
              <div class="sidefilter">
                <form class="toc-filter">
                  <span class="glyphicon glyphicon-filter filter-icon"></span>
                  <input type="text" id="toc_filter_input" placeholder="Enter here to filter..." onkeypress="if(event.keyCode==13) {return false;}">
                </form>
              </div>
              <div class="sidetoc">
                <div class="toc" id="toc">
                  
                  <ul class="nav level1">
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Getting Started</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <span class="expand-stub"></span>
                            <a href="ML-Agents-Overview.html" title="ML-Agents Overview" class="">ML-Agents Overview</a>
                              
                              <ul class="nav level3">
                                <li class="">
                                  <a href="Background-Unity.html" title="Background Unity" class="">Background Unity</a>
                                </li>
                                <li class="">
                                  <a href="Background-Machine-Learning.html" title="Background Machine Learning" class="">Background Machine Learning</a>
                                </li>
                                <li class="">
                                  <a href="Background-TensorFlow.html" title="Background TensorFlow" class="">Background TensorFlow</a>
                                </li>
                              </ul>  </li>
                          <li class="">
                            <span class="expand-stub"></span>
                            <a href="Installation.html" title="Installation &amp; Setup" class="">Installation &amp; Setup</a>
                              
                              <ul class="nav level3">
                                <li class="">
                                  <a href="Background-Jupyter.html" title="Background Jupyter Notebooks" class="">Background Jupyter Notebooks</a>
                                </li>
                                <li class="">
                                  <a href="Using-Docker.html" title="Background Docker Setup" class="">Background Docker Setup</a>
                                </li>
                              </ul>  </li>
                          <li class="">
                            <a href="Getting-Started-with-Balance-Ball.html" title="Getting Started with the 3D Balance Ball Environment" class="">Getting Started with the 3D Balance Ball Environment</a>
                          </li>
                          <li class="">
                            <a href="Learning-Environment-Examples.html" title="Example Environment" class="">Example Environment</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Creating Learning Environments</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="Learning-Environment-Create-New.html" title="Making a New Learning environment" class="">Making a New Learning environment</a>
                          </li>
                          <li class="">
                            <a href="Learning-Environment-Design.html" title="Designing a Learning environment" class="">Designing a Learning environment</a>
                          </li>
                          <li class="">
                            <a href="Learning-Environment-Best-Practices.html" title="Learning Environment Best Practices" class="">Learning Environment Best Practices</a>
                          </li>
                          <li class="">
                            <a href="Feature-Monitor.html" title="Using the Monitor Class" class="">Using the Monitor Class</a>
                          </li>
                          <li class="">
                            <a href="Using-TensorFlow-Sharp-in-Unity.html" title="TensorFlowSharp in Unity" class="">TensorFlowSharp in Unity</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Training</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="Training-ML-Agents.html" title="Training ML-Agents" class="">Training ML-Agents</a>
                          </li>
                          <li class="">
                            <a href="Training-PPO.html" title="Training with Proximal Policy Optimization" class="">Training with Proximal Policy Optimization</a>
                          </li>
                          <li class="">
                            <a href="Training-Curriculum-Learning.html" title="Training with Curriculum Learning" class="">Training with Curriculum Learning</a>
                          </li>
                          <li class="">
                            <a href="Training-Imitation-Learning.html" title="Training with Imitation Learning" class="">Training with Imitation Learning</a>
                          </li>
                          <li class="">
                            <a href="Feature-Memory.html" title="Training with LSTM" class="">Training with LSTM</a>
                          </li>
                          <li class="">
                            <a href="Training-on-Amazon-Web-Service.html" title="Training on the Cloud with Amazon Web Services" class="">Training on the Cloud with Amazon Web Services</a>
                          </li>
                          <li class="">
                            <a href="Using-Tensorboard.html" title="Using TensorBoard to Observe Training" class="">Using TensorBoard to Observe Training</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Help</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="Migrating-v0.3.html" title="Migrating to ML-Agents v.0.3" class="">Migrating to ML-Agents v.0.3</a>
                          </li>
                          <li class="">
                            <a href="Glossary.html" title="ML-Agents Glossary" class="">ML-Agents Glossary</a>
                          </li>
                          <li class="">
                            <a href="Limitations-and-Common-Issues.html" title="Limitations &amp; Common Issues" class="">Limitations &amp; Common Issues</a>
                          </li>
                        </ul>  </li>
                  </ul>        </div>
              </div>
            </div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="installing-ml-agents-for-windows">Installing ML-Agents for Windows</h1>

<p>ML-Agents supports Windows 10. While it might be possible to run ML-Agents using other versions of Windows, it has not been tested on other versions. Furthermore, ML-Agents has not been tested on a Windows VM such as Bootcamp or Parallels.</p>
<p>To use ML-Agents, you install Python and the required Python packages as outlined below. This guide also covers how set up GPU-based training (for advanced users). GPU-based training is not required for the v0.3 release of ML-Agents. However, training on a GPU might be required by future versions and features.</p>
<h2 id="step-1-install-python-via-anaconda">Step 1: Install Python via Anaconda</h2>
<p><a href="https://www.anaconda.com/download/#windows">Download</a> and install Anaconda for Windows. By using Anaconda, you can manage separate environments for different distributions of Python. Python 3 is required as we no longer support Python 2. In this guide, we are using Python version 3.5 (Anaconda comes with Python 3.6, we will create an environment with python 3.5) and Anaconda version 5.1 (<a href="https://repo.continuum.io/archive/Anaconda3-5.1.0-Windows-x86_64.exe">64-bit</a> or <a href="https://repo.continuum.io/archive/Anaconda3-5.1.0-Windows-x86.exe">32-bit</a> direct links).</p>
<p align="center">
    <img src="../images/anaconda_install.PNG" alt="Anaconda Install" width="500" border="10">
</p>

<p>We recommend the default <em>advanced installation options</em>. However, select the options appropriate for your specific situation.</p>
<p align="center">
    <img src="../images/anaconda_default.PNG" alt="Anaconda Install" width="500" border="10">
</p>

<p>After installation, you must open <strong>Anaconda Navigator</strong> to finish the setup. From the Windows search bar, type <em>anaconda navigator</em>. You can close Anaconda Navigator after it opens.
If environment variables were not created, or if you see the error &quot;conda is not recognized as internal or external command&quot;, in System Variables, &quot;Path&quot; add the following new paths:</p>
<pre><code>    C:\ProgramData\Anaconda3\Scripts
    C:\ProgramData\Anaconda3\Scripts\conda.exe
    C:\ProgramData\Anaconda3
    C:\ProgramData\Anaconda3\python.exe
</code></pre><h2 id="step-2-setup-and-activate-a-new-conda-environment">Step 2: Setup and Activate a New Conda Environment</h2>
<p>You will create a new <a href="https://conda.io/docs/">Conda environment</a> to be used with ML-Agents. This means that all the packages that you install are localized to just this environment. It will not affect any other installation of Python or other environments. Whenever you want to run ML-Agents, you will need activate this Conda environment.</p>
<p>To create a new Conda environment, open a new Anaconda Prompt (<em>Anaconda Prompt</em> in the search bar) and type in the following command:</p>
<pre><code>conda create -n ml-agents python=3.5
</code></pre><p>You may be asked to install new packages. Type <code>y</code> and press enter <em>(make sure you are connected to the internet)</em>. You must install these required packages. The new Conda environment is called ml-agents and uses Python version 3.6.</p>
<p align="center">
    <img src="../images/conda_new.PNG" alt="Anaconda Install" width="500" border="10">
</p>

<p>To use this environment, you must activate it. <em>(To use this environment In the future, you can run the same command)</em>. In the same Anaconda Prompt, type in the following command:</p>
<pre><code>conda activate ml-agents
</code></pre><p>You should see <code>(ml-agents)</code> prepended on the last line.</p>
<p>Next, install <code>tensorflow</code>. Install this package using <code>pip</code> - which is a package management system used to install Python packages. Latest versions of Tensorflow won&#39;t work, so you will need to make sure that you install version 1.4.0. In the same Anaconda Prompt, type in the following command <em>(make sure you are connected to the internet)</em>:</p>
<pre><code>pip install tensorflow==1.4.0
</code></pre><h2 id="step-3-install-required-python-packages">Step 3: Install Required Python Packages</h2>
<p>ML-Agents depends on a number of Python packages. Use <code>pip</code> to install these Python dependencies.</p>
<p>If you haven&#39;t already, clone the ML-Agents Github repository to your local computer. You can do this using Git (<a href="https://git-scm.com/download/win">download here</a>) and running the following commands in an Anaconda Prompt <em>(if you open a new prompt, be sure to activate the ml-agents Conda environment by typing <code>activate ml-agents</code>)</em>:</p>
<pre><code>git clone git@github.com:Unity-Technologies/ml-agents.git
</code></pre><p>If you don&#39;t want to use Git, you can always directly download all the files <a href="https://github.com/Unity-Technologies/ml-agents/archive/master.zip">here</a>.</p>
<p>In our example, the files are located in <code>C:\Downloads</code>. After you have either cloned or downloaded the files, from the Anaconda Prompt, change to the python directory inside the ML-agents directory:</p>
<pre><code>cd C:\Downloads\ml-agents\python
</code></pre><p>Make sure you are connected to the internet and then type in the Anaconda Prompt:</p>
<pre><code>pip install .
</code></pre><p>This will complete the installation of all the required Python packages to run ML-Agents. </p>
<h2 id="optional-step-4-gpu-training-using-ml-agents">(Optional) Step 4: GPU Training using ML-Agents</h2>
<p>Not required to use v0.3 for ML-Agents. This is a guide for advanced users who want to train using GPUs. Additionally, you will need to check if your GPU is CUDA compatible. Please check Nvidia&#39;s page <a href="https://developer.nvidia.com/cuda-gpus">here</a>.</p>
<p>As of ML-Agents v0.3, only CUDA 8 and cuDNN 6 is supported.</p>
<h3 id="install-nvidia-cuda-toolkit">Install Nvidia CUDA toolkit</h3>
<p><a href="https://developer.nvidia.com/cuda-toolkit-archive">Download</a> and install the CUDA toolkit from Nvidia&#39;s archive. The toolkit includes GPU-accelerated libraries, debugging and optimization tools, a C/C++ (Step Visual Studio 2015) compiler and a runtime library and is needed to run ML-Agents. In this guide, we are using version 8.0.61 (<a href="https://developer.nvidia.com/compute/cuda/8.0/Prod2/network_installers/cuda_8.0.61_win10_network-exe">direct link</a>). </p>
<p>Before installing, please make sure you <strong>close any running instances of Unity or Visual Studio</strong>.</p>
<p>Run the installer and select the Express option. Note the directory where you installed the CUDA toolkit. In this guide, we installed in the directory <code>C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v8.0</code></p>
<h3 id="install-nvidia-cudnn-library">Install Nvidia cuDNN library</h3>
<p><a href="https://developer.nvidia.com/cudnn">Download</a> and install the cuDNN library from Nvidia. cuDNN is is a GPU-accelerated library of primitives for deep neural networks. Before you can download, you will need to sign up for free to the Nvidia Developer Program.</p>
<p align="center">
    <img src="../images/cuDNN_membership_required.png" alt="cuDNN membership required" width="500" border="10">
</p>

<p>Once you&#39;ve signed up, go back to the cuDNN <a href="https://developer.nvidia.com/cudnn">downloads page</a>. You may or may not be asked to fill out a short survey. When you get to the list cuDNN releases, <strong>make sure you are downloading the right version for the CUDA toolkit you installed in Step 1.</strong>  In this guide, we are using version 6.0 for CUDA toolkit version 8.0 (<a href="https://developer.nvidia.com/compute/machine-learning/cudnn/secure/v6/prod/8.0_20170307/cudnn-8.0-windows10-x64-v6.0-zip">direct link</a>).</p>
<p>After you have downloaded the cuDNN files, you will need to extract the files into the CUDA toolkit directory. In the cuDNN zip file, there are three folders called <code>bin</code>, <code>include</code>, and <code>lib</code>. </p>
<p align="center">
    <img src="../images/cudnn_zip_files.PNG" alt="cuDNN zip files" width="500" border="10">
</p>

<p>Copy these three folders into the CUDA toolkit directory. The CUDA toolkit directory is located at <code>C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v8.0</code></p>
<p align="center">
    <img src="../images/cuda_toolkit_directory.PNG" alt="cuda toolkit directory" width="500" border="10">
</p>

<h3 id="set-environment-variables">Set Environment Variables</h3>
<p>You will need to add one environment variable and two path variables.</p>
<p>To set the environment variable, type <code>environment variables</code> in the search bar (this can be reached by hitting the Windows key or the bottom left Windows button). You should see an option called <strong>Edit the system environment variables</strong>. </p>
<p align="center">
    <img src="../images/edit_env_var.png" alt="edit env variables" width="250" border="10">
</p>

<p>From here, click the <strong>Environment Variables</strong> button. Click <strong>New</strong> to add a new system variable <em>(make sure you do this under <em>_System variables</em></em> and not User variables_. </p>
<p align="center">
    <img src="../images/new_system_variable.PNG" alt="new system variable" width="500" border="10">
</p>

<p>For <strong>Variable Name</strong>, enter <code>CUDA_HOME</code>. For the variable value, put the directory location for the CUDA toolkit. In this guide, the directory location is <code>C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v8.0</code>. Press <strong>OK</strong> once.</p>
<p align="center">
    <img src="../images/system_variable_name_value.PNG" alt="system variable names and values" width="500" border="10">
</p>

<p>To set the two path variables, inside the same <strong>Environment Variables</strong> window and under the second box called <strong>System Variables</strong>, find a variable called <code>PATH</code> and click <strong>Edit</strong>. You will add two directories to the list. For this guide, the two entries would look like:</p>
<pre><code>C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v8.0\lib\x64
C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v8.0\extras\CUPTI\libx64
</code></pre><p>Make sure to replace the relevant directory location with the one you have installed. <em>Please note that case sensitivity matters</em>.</p>
<p align="center">
    <img src="../images/path_variables.PNG" alt="Path variables" width="500" border="10">
</p>

<h3 id="install-tensorflow-gpu">Install TensorFlow GPU</h3>
<p>Next, install <code>tensorflow-gpu</code> using <code>pip</code>. In an Anaconda Prompt with the Conda environment ml-agents activated, type in the following command <em>(make sure you are connected to the internet)</em>:</p>
<pre><code>pip install tensorflow-gpu==1.4.0
</code></pre><p>Lastly, you should test to see if everything installed properly and that TensorFlow can identify your GPU. In the same Anaconda Prompt, type in the following command:</p>
<pre><code class="lang-python">import tensorflow as tf

sess = tf.Session(config=tf.ConfigProto(log_device_placement=True))
</code></pre><p>You should see something similar to:</p>
<pre><code>Found device 0 with properties ...
</code></pre><p>Step Visual Studio 2015: CUDA 8.0 is not compatible with Visual Studio 2017, so you will need an older version. Uninstall Visual Studio 2017 that comes with Unity, download Visual Studio Enterprise 2015 and install it with the Windows SDK. If you don&#39;t want/ can&#39;t install Visual Studio Enterprise 2015, you will need: 
    <a href="https://www.microsoft.com/en-us/download/details.aspx?id=48145">Visual C++ Redistributable for Visual Studio 2015</a>,
    <a href="https://www.visualstudio.com/vs/older-downloads/">Visual Studio Community 2015</a> + <a href="https://msdn.microsoft.com/en-us/library/mt683786.aspx">Windows SDK</a>.</p>
<h2 id="acknowledgements">Acknowledgements</h2>
<p>We would like to thank <a href="https://unity3d.college/2017/10/25/machine-learning-in-unity3d-setting-up-the-environment-tensorflow-for-agentml-on-windows-10/">Jason Weimann</a> and <a href="http://blog.nitishmutha.com/tensorflow/2017/01/22/TensorFlow-with-gpu-for-windows.html">Nitish S. Mutha</a> for writing the original articles which were used to create this guide.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/Unity-Technologies/ml-agents/blob/feature-docfx/doc-src/articles/Installation-Windows.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
